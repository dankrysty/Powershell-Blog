<html>
	<head>
		<title>Powershell Scripting Blog</title>
	</head>
	<body>
		<div id="shortDesc">
			<h1><b>Welcome to Dan's Powershell Blog!</b></h1>
			Here is a guilde to learning 
			<a href="https://docs.microsoft.com/en-us/powershell/scripting/overview?view=powershell-7.2" target="_blank">
				<b>Microsoft Powershell &copy</b>
			</a>
			with my ecperiences. I am learning and building my Powershell knowledge from the basics and understanding the purpose of Powershell to simple commands, then later will get into scripts and some more complexities with adding a GUI interface via C#. <br/>
			I hope that this blog will help those that want to learn the basics of powershell or understand the "Power" that it beholds as a Systems Administrator or just even someone learning as just a hobby. Without further adue, lets just dive into it!<br/>
		</div>
		<!--
			blog post with border line
			Title:,Date:,Desc:,Photo:
		-->
		<!--Line-Break-->
		<hr>
		<!--Post-->
		<div id="post0"> 
			<!--Date and Title-->
			<h4 style="color: blue">
				<u>
				6/18/22<br>
				Episode 1: Let's get started: Powershell Basics 
				</u>
			</h4>
			<!--Main Content-->
			<div>
				<!--Section Title-->
				<p>
					<b>
					What is powershell?
					</b>
				</p>
				<p>
					Powershell is a cross-platform that uses command-line shell language, and configuration management framework. Powershell is a cross platform task automation solution for Windows, Linux, and macOS. Powershell is a modern command shell that combines the best features of other popular shells and even includes alot of aliases to help those comming from other shell platforms. It also accepts and returns .NET objects. Here are some features that Powershell includes.
				</p>
				<ul>
					<li>Strong commandline history</li>
					<li>Tab completion and command prediction</li>
					<li>Supports command and parameter aliases</li>
					<li>Pipeline for chaining commands</li>
					<li>Elaborate in-console help system (simillar to Unix <i>man</i> pages)</li>
				</ul>
				<!--Section Title-->
				<p>
					<b>
					Why is powershell so helpful?
					</b>
				</p>
				<p>
					Powershell is helpful in many differnt ways. It can be used for system administrator controls, evnironment setup, automating tasks, and user system control. There will be more details added to this later.
				</p>
				<!--Section Title-->
				<p>
					<b>
					Some basic Syntax. Nouns and Verbs.
					</b>
				</p>
				<p>
					So with Powershell the syntax works by using a <b>Noun</b> and a <b>Verb</b>. The Verb usually goes first <i>i.e. Get</i> followed by a <b>-</b> and then the Noun. <i>i.e. Get-Services</i>. This as a whole is called a <b>Commandlet</b> or <b>cmdlets</b>.
				</p>
				<!--Section Title-->
				<p>
					<b>
					Understanding your resources.
					</b>
				</p>
				<p>
					Powershell has a extremely resourceful help section called <b>Get-Help</b>. It can be a very helpful tool to use when trying to work on a task and uderstanding the parameters and the arguments needed or not for each itteration of the command. Lets try it! Open up Powershell on your computer. If it is not on your machine you can download the latest version <a href="https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell-7.2" target="_blank">here</a>.
				</p>
				<textarea disabled="true" cols="100" rows="1">Get-Help
				</textarea><br><br>
				<img src="./imgs/Get-Help.png" alt="Get-Help"><br><br>
				<p>
					As you can see when you put in this comdlet, it sends you a help guide and explains the different aspects to what the Get-Help cmdlet does. You can use this commandlet to get help on other cmdlets by putting the next cmdlet after it.<br><br>
				</p>
				<textarea disabled="true" cols="100" rows="1">Get-Help Get-Alias
				</textarea><br><br>
				<img src="./imgs/Get-Help_Get-Alias.png" alt="Get-Help"><br><br>
				<p>
					Here as you can see the Get-Help cmdlet helps to get the name, syntax, alias, and remarks about the cmdlet in question. Sometimes you can see more of a long description or detailed list by adding the <b>flag</b>, uses <i>-</i> character, <b>-Detailed</b>. Let's try it!
				</p>
				<textarea disabled="true" cols="100" rows="1">Get-Help Get-Alias -Detailed
				</textarea><br><br>
				<img src="./imgs/Get-Help_Get-Alias_Detailed.png" alt="Get-Help"><br><br>
				<p>
					Here you can see that it even now explains the parameters you can use and in some cases MUST use. If you want to test out some cndlets of your own feel free you can do that now. Also, you should try the <i>TAB</i> key to cycle through the optional flags or parameters you can choose from for your full command.
				</p>
				<p>
					Now there is another helpful tool you can use to work on code at the same time. So first clear the screen by using the cmdlet <b>Clear-Host</b> or the alias <b>cls</b>. Then type in <b>Get-Help Get-Alias -Showwindow</b>. This will open up the help for this cmdlet in a seperate window, which is scalable and can be searched. Ok, now its your turn.
				</p>
				<textarea disabled="true" cols="100" rows="1">Get-Help Get-Alias -Showwindow
				</textarea><br><br>
				<img src="./imgs/Get-Help_Get-Alias_Showwindow.png" alt="Get-Help"><br><br>
				<p>
					As you can see it is not the Powershell Terminal Window and it is totally seperate so you can have it open while working in the terminal seperately. This allows multitasking and makes the Help cmdlet so much more powerful. If you want the latest help, right click on the Powershell application and click <i>Run as Administrator</i> and type in <b>Update-Help</b>.
				</p>
			</div><!--End Main Content-->
		</div><!--End Post-->
		<hr>
		<!--Post-->
		<div id="post1"> 
			<!--Date and Title-->
			<h4 style="color: blue">
				<u>
				6/19/22<br>
				Episode 2: Running Powershell as User vs Administrator 
				</u>
			</h4>
			<!--Main Content-->
			<div>
				<!--Section Title-->
				<p>
					<b>
					Why would you want to run as an Aministrator vs a User?
					</b>
				</p>
				<p>
					There are several reasons that one would like to run Powershell as an Administrator. The first would be to make system settings or to make changes to the execution policy. We will dive more into system changes later on, but today we will talk about the <b>Execution Policy</b>. Now there are ways that you can search for things in powershell so lets try to use <b>Get-Help</b> for the <b>Get-ExecutionPolicy</b>. Lets try and search for anything that has the words <i>execution</i> in them. The <b>*</b> is used as a wild card search. This means that if you put <b>Get-Help *execution*</b> then that will find anything with execution in it and it can have something on either side of it. Let's see!
				</p>
				<textarea disabled="true" cols="100" rows="1">Get-Help Get-Help *execution*
				</textarea><br><br>
				<img src="./imgs/Get-Help_Get-Alias_execution.png" alt="Get-Help"><br><br>
				<p>
					Here you can see a table with a list of three cmdlets. I want to take notice for two of them. The first one is <b>Get-ExceptionPolicy</b>, and the second one is <b>Set-ExceptionPolicy</b>. These are the permissions for users to run Powershell scripts. By default the Exception Policy is set to Restricted. There are different scopes:<br>
				</p>
				<ul>
					<li>All Signed:<br>
						-Scripts can run<br>
						-Requires all scripts and configuration files to be signed by a trusted publisher, including scripts that you write on the local computer<br>
						-Prompts you before running scripts from publishers that you havent yet classified as trusted or untrusted<br>
						-Risks running signed, but malicious scripts<br>
					</li>
					<li>Bypass<br>
						-Nothing is blocked and there are no warnings or prompts<br>
						-This execution policy is designed for configurations in which a Powershell script is built into a larger application or for configurations in which Powershell is the foundation for the program that has its own security model.<br>
					</li>
					<li>Default<br>
						-Sets the default execution policy<br>
						-<i>Restricted</i> for Windows clients<br>
						-<i>RemoteSigned</i> for Windows Servers<br>
					</li>
					<li>RemoteSigned<br>
						-The default execution policy for Windows server computers<br>
						-Scripts can run<br>
						-Requires a digital signature from a trusted publisher on scripts and configuration files that are downloaded from the internet which includes email and instant messaging programs<br>
						-Doesn't require digital signatures on scripts that are written on the local computer and not downloaded from the internet<br>
						-Runs scripts that are downloaded from the internet and not signed, if the scripts are unblocked, such as by using the <b>Unblock-File</b> cmdlet<br>
						-Risks running unsigned scripts from sources other than the internet and signed scripts that could be malicious<br>
					</li>
					<li>Restricted<br>
						-The default execution policy for Windows client computers<br>
						-Permits individual commands, but does not allow scripts<br>
						-Prevents running of all script files, including formatting and configuration files (.ps1xml), module script files (.psm1), and PowerShell profiles (.ps1)<br>
					</li>
					<li>Undefined<br>
						-There is no execution policy set in the current scope<br>
						-If the execution policy in all scopes is Undefined, the effective execution policy is Restricted for Windows clients and RemoteSigned for Windows Server<br>
					</li>
					<li>Unrestricted<br>
						-The default execution policy for non-Windows computers and cannot be changed<br>
						-Unsigned scripts can run. There is a risk of running malicious scripts<br>
						-Warns the user before running scripts and configuration files that are not from the local intranet zone<br>
					</li>
				</ul>
				<p>
					Now Powershell by default will not allow you to run any scripts what so ever becasue it is set to <b>Restricted</b>. If you use the cmdlet <b>Get-ExecutionPolicy</b>, then you will see what it is set to. Now there are several ways around this, becasue Microsoft did not intend it to be a Security protocol for the system there are work arounds which allow you to run scripts and to also run local commands and cmdlets too. Lets go over ways around this.<br>
					First way is to open up Powershell as Administrator. Here you can use the cmdlet <b>Set-ExecutionPolicy</b>. This will allow you to change the Execution Policy as a whole for the User. This may not be exactly what you are looking for becasuse you may want to run a script without being an Administrator for the system. You may want to make a script for automation that will help users not just Administrators.
				</p>
				<p>
					The Next option that I have found to be quite successfull is the <b>-ExecutionPolicy -Bypass</b> flags. What happens is, it allows the user to bypass the -ExecutionPolicy. This will allow the script to be run without the limitations of the <b>Restricted</b> Execution Policy. I have not tried it yet with more complex scripts yet, but will try that soon enough. Here is a simple <b>Write-Host</b> cmdlet, which writes to the screen like <b>Echo</b> will in the Command Promt. Ok, I will show you a few things; First, I will show you how you can use <b>Write-Host</b> or Echo in the Powershell terminal and it will show you the result that would be given based off the arument passed through the cmdlet when run. The second thing, will be how to make a Powershell file (estenstion .ps10) that will not run if you try it. Lastly, I will show you an example of how you can bypass this, to start writing scripts and saving them to a file and running the script from the terminal. Ok, Let's do it!
				</p>
				<textarea disabled="true" cols="100" rows="1">Echo "Hello"
				</textarea><br><br>
				<textarea disabled="true" cols="100" rows="1">Echo Hello
				</textarea><br><br>
				<textarea disabled="true" cols="100" rows="1">Write-Host "hello world"
				</textarea><br><br>
				<textarea disabled="true" cols="100" rows="1">write-host hello world
				</textarea><br><br>
				<img src="./imgs/Echo_Write-Host.png" alt="reference image"><br><br>
				<p>
					So we can see that they each output the same. It will be interesting to see how that effects when saving it as a variable and seeing if there is a differnce and if it effects anything. But you can see the alias working the same as the true powershell cmdlet. 
				</p>
				<p>
					Ok so now the next thing you will need is a proper IDE for debugging and testing your code. After researching what the community says about it, they recomend the Visual Studio Code. So <a href="https://code.visualstudio.com/download" target="_blank">here</a> is a link to the free download through Microsoft. Go and download that now, or some other powershell programming edditor (<a href="https://notepad-plus-plus.org/downloads/v8.4.2/" target="_blank">Notepadd++</a>, <a href="https://www.sublimetext.com/3" target="_blank">Sublime Text</a>, etc.)
				</p>
				<p>
					Ok now open up the text editor. I typically like to set the language to the code that I am writing in. So In Visual Code you will select new text file. It will promt you to select a language and search for Powershell and select the language and save your file locally on your computer. Type in the command below and save the file as a .ps1 file extension.
				</p>
				<textarea disabled="true" cols="100" rows="1">Write-Host "Congratulations! Your first script executed successfully"
				</textarea><br><br>
				<textarea disabled="true" cols="100" rows="1">Write-Host ""
				</textarea><br><br>
				<textarea disabled="true" cols="100" rows="1">Write-Host "You wrote your first Powershell script"
				</textarea><br><br>
				<img src="./imgs/VS_1.1.png" alt="reference image"><br><br>
				<p>
					Once you have saved your file we are going to open up Powershell and run the scrpit though the terminal. So copy the following command into the terminal. (Replace the path with your full path the file on your machine)
				</p>
				<textarea disabled="true" cols="100" rows="1">Powershell.exe -ExecutionPolicy Bypass -File C:\Users\DK\Documents\Code\Powershell\Testing\test1.ps1
				</textarea><br><br>
				<img src="./imgs/VS_1.2.png" alt="reference image"><br><br>
				You Now made your first Powershell script and now we can work on other processes with powershell comming up.
			</div>
		</div>
		<div id="post2"> 
			<h4 style="color: blue">
				<u>
				6/25/22<br>
				Episode 3: Other Valuable Cmdlets
				</u>
			</h4>
			<div>
				<p>
					<b>
					What are some other important cmdlets?
					</b>
				</p>
				<p>
					So lets dive into other cmdlets that will be important in this Powershell journey. Now the thing that I want you to know is that they all are important and all add value to Powershell as a whole. But we will step through some ones that you may use more often. Here is a list of the cmdlets I will go over. We will go over the ressults individually. As we run through each cmdlet, see if you can think of processes that these can help to automate
				</p>
				<table style="padding: px;border: 1px solid blue; border-collapse: collapse;">
						<th style="color: blue;padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<b>Cmdlet Name</b>
						</th>
						<th style="color: blue;padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<b>Short Description</b>
						</th>
						<th style="color: blue;padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<b>Example</b>
						</th>
					</tr>
					<tr>
						<th style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<i>
								Get command
							</i>
						</th>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Gets the details on the command selected as the argument
						</td>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Get-Command g*service
						</td>
					</tr>
					<tr>
						<th style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<i>
								Get service
							</i>
						</th>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Outputs a list of installed services on the system
						</td>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Get-Services g*
						</td>
					</tr>
					<tr>
						<th style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<i>
								Convert to html
							</i>
						</th>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Converts the code to a sendable/recievable .html format
						</td>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							ConvertTo-Html -InputObject (Get-Date)
						</td>
					</tr>
					<tr>
						<th style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<i>
								Export to .csv file
						</th>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Export a file to .csv file format 
						</td>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Get-Command *environment | -Name Export-Csv -Path .\WmiData.csv -NoTypeInformation
						</td>
					</tr>
					<tr>
						<th style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<i>
								Select object
							</i>
						</th>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Allows for specific selection of properties to be called as an argument or changed
						</td>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Get-Process | Select-Object -Property ProcessName, Id, WS
						</td>
					</tr>
					<tr>
						<th style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<i>
								Get process
							</i>
						</th>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Gets the list of processes running on the local computer
						</td>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Get-Process winword, explorer | Format-List *
						</td>
					</tr>
					<tr>
						<th style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<i>
								Stop process
							</i>
						</th>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Stops the process selected as an argument on the local computer
						</td>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Stop-Process -Name "notepad"
						</td>
					</tr>
					<tr>
						<th style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<i>
								Start process
							</i>
						</th>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Starts the process selected as an argument on the local computer
						</td>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Start-Process -Name "notepad"
						</td>
					</tr>
					<tr>
						<th style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							<i>
								Invoke web request
							</i>
						</th>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							Gets content from a web page on the internet
						</td>
						<td style="padding: 10px;border: 1px solid blue; border-collapse: collapse;">
							(Invoke-WebRequest -Uri "https://devblogs.microsoft.com/powershell/").Links.Href
						</td>
					</tr>
				</table>
				<p>
					Ok so as you can see some of these examples may look confusing or overwhelming first but that is totally unsderstandable. We will go through each one and test them and then break them down in more detail. One step I would recommend doing before trying a new cmdlet I would look up the help menu for each one and then to get some examples by adding the <b>-Detailed</b> flag <i>(spoiler* some of these examples are from there)</i>. Now that we're ready to get started lets open our Powershell terminal and lets get started.
				</p>
				<p>
					So the first and second one we will combine together. They are the <b>Get-Command</b> and <b>Get-Service</b> cmdlets. They will help to Get the commands you are looking for a certain task in a script. It can be a powerful tool that can help to get the right tools need to complete the lines of code you need. Let's take a look at it.
				</p>
				<textarea disabled="true" cols="100" rows="1">Get-Command get*service
				</textarea><br><br>
				<img src="./imgs/PS_3.1.png" alt="reference image"><br><br>
				<p>
					As you can see the wild card <b>*</b> is a very helpfull tool. What it does is alows there to be anything to fill its spot. So as you can see here, our output is all services that start with the letter <b>g</b> and must end in <b>service</b>. Here you can get a shorter list than just <b>Get-Command *service</b>
				</p>
				<p>
					The next cmdlet we will work with is <b>Get-Service</b>. Here as you see it gets the list of services running on your local machine. 
				</p>
				<textarea disabled="true" cols="100" rows="1">Get-Service g*
				</textarea><br><br>
				<img src="./imgs/PS_3.2.png" alt="reference image"><br><br>
				<p>
					As you can see it lists all the Services that are runing and it will show if it is stopped or running.This is important to know so that you do not stop a serivice from runnung that you do not want to and vice versa for starting a service.
				</p>
				<p>
					The next cmdlet we will test out is the <b>ConvertTo-Html</b>
					
				</p>
			</div>
		</div>
	</body>
</html>
			<!--Text block and image-->
<!--
				<textarea disabled="true" cols="100" rows="1">Echo "Hello World"
				</textarea><br><br>
				<img src="./imgs/file.png" alt="reference image"><br><br>
-->
			<!--Post-->
<!--
			<div id="post2"> 
				<h4 style="color: blue">
					<u>
					Enter Date Here<br>
					Episode #: Episode Title Here
					</u>
				</h4>
				<div>
					<p>
						<b>
						Title Here
						</b>
					</p>
					<p>
						First Paragraph
					</p>
					<textarea disabled="true" cols="100" rows="1">text input area
					</textarea><br><br>
					<img src="./imgs/file.png" alt="reference image"><br><br>
					<p>
						Second Paragraph
					</p>
				</div>
			</div>
-->